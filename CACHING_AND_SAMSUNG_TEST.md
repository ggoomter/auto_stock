# ë°±í…ŒìŠ¤íŠ¸ ìºì‹± ì‹œìŠ¤í…œ ë° ì‚¼ì„±ì „ì ì „ëµ ë¹„êµ ê°€ì´ë“œ

## ğŸ“Œ ê°œìš”

ì´ ë¬¸ì„œëŠ” ë‹¤ìŒ ê¸°ëŠ¥ë“¤ì— ëŒ€í•œ ê°€ì´ë“œì…ë‹ˆë‹¤:

1. **ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìºì‹± ì‹œìŠ¤í…œ**: ë™ì¼í•œ íŒŒë¼ë¯¸í„°ë¡œ ìš”ì²­ ì‹œ API/LLM í˜¸ì¶œ ì—†ì´ ì¦‰ì‹œ ê²°ê³¼ ë°˜í™˜
2. **ì‚¼ì„±ì „ì ì „ëµ ë¹„êµ í…ŒìŠ¤íŠ¸**: 2024ë…„ 100ë§Œì› íˆ¬ì ì‹œ 8ê°€ì§€ ëŒ€ê°€ ì „ëµ ì„±ê³¼ ë¹„êµ

## ğŸš€ ì£¼ìš” ê¸°ëŠ¥

### 1. ë°±í…ŒìŠ¤íŠ¸ ìºì‹± ì‹œìŠ¤í…œ

**ëª©ì **: ë™ì¼í•œ ë°±í…ŒìŠ¤íŠ¸ ìš”ì²­ ì‹œ ê³„ì‚° ì‹œê°„ ë° API ë¹„ìš© ì ˆê°

**ì‘ë™ ë°©ì‹**:
- ì²« ë²ˆì§¸ ìš”ì²­: ë°±í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ â†’ ê²°ê³¼ ìºì‹œ ì €ì¥
- ë‘ ë²ˆì§¸ ìš”ì²­ (ë™ì¼ íŒŒë¼ë¯¸í„°): ìºì‹œì—ì„œ ì¦‰ì‹œ ë°˜í™˜ (API/LLM í˜¸ì¶œ ì—†ìŒ)

**ìºì‹œ í‚¤ ìƒì„±**:
```python
symbols + start_date + end_date + strategy_name + initial_capital
â†’ SHA256 í•´ì‹œ â†’ ìºì‹œ íŒŒì¼ëª…
```

**ìºì‹œ ì €ì¥ ìœ„ì¹˜**:
```
backend/cache/backtest_results/{hash}.json
```

**ìºì‹œ ìë™ ê´€ë¦¬**:
- íŒŒì¼ ê¸°ë°˜ ìºì‹± (Redis ë¶ˆí•„ìš”)
- ë¬´ì œí•œ ë³´ê´€ (ìˆ˜ë™ ì‚­ì œ ê°€ëŠ¥)
- ìºì‹œ í†µê³„ API ì œê³µ

### 2. ì„±ëŠ¥ í–¥ìƒ

**ì˜ˆìƒ ì†ë„**:
- ì²« ì‹¤í–‰: 30-60ì´ˆ (ë°±í…ŒìŠ¤íŠ¸ ìˆ˜í–‰)
- ìºì‹œ ì‚¬ìš©: 0.1-0.5ì´ˆ (ì¦‰ì‹œ ë°˜í™˜)
- **10-100ë°° ì†ë„ í–¥ìƒ**

## ğŸ“ ìƒˆë¡œ ì¶”ê°€ëœ íŒŒì¼

### 1. `backend/app/services/backtest_cache.py`
ë°±í…ŒìŠ¤íŠ¸ ìºì‹± ì„œë¹„ìŠ¤

**ì£¼ìš” ë©”ì„œë“œ**:
```python
get(symbols, start_date, end_date, strategy_name, initial_capital)
# â†’ ìºì‹œ ì¡°íšŒ (ìˆìœ¼ë©´ Dict, ì—†ìœ¼ë©´ None)

set(symbols, start_date, end_date, strategy_name, initial_capital, result)
# â†’ ìºì‹œ ì €ì¥

clear_cache(older_than_days=None)
# â†’ ìºì‹œ ì‚­ì œ (ì¼ìˆ˜ ì§€ì • ê°€ëŠ¥)

get_cache_stats()
# â†’ ìºì‹œ í†µê³„ (íŒŒì¼ ê°œìˆ˜, ì´ ìš©ëŸ‰)
```

### 2. `tests/test_samsung_strategies.py`
ì‚¼ì„±ì „ì ì „ëµ ë¹„êµ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

**í…ŒìŠ¤íŠ¸ ë‚´ìš©**:
- 8ê°€ì§€ ëŒ€ê°€ ì „ëµ ë¹„êµ (buffett, lynch, graham, dalio, livermore, soros, druckenmiller, oneil)
- 2024ë…„ 1ì›” 1ì¼ ~ 12ì›” 31ì¼
- ì´ˆê¸° ìë³¸: 1,000,000ì›
- ê²°ê³¼ ì €ì¥: `test_results/samsung_2024/`

**ì‹¤í–‰ íë¦„**:
1. ì²« ë²ˆì§¸ ì‹¤í–‰: 8ê°œ ì „ëµ ë°±í…ŒìŠ¤íŠ¸ + ìºì‹œ ì €ì¥
2. ë‘ ë²ˆì§¸ ì‹¤í–‰: ìºì‹œì—ì„œ ì¦‰ì‹œ ë°˜í™˜
3. ì„±ëŠ¥ ë¹„êµ: ì‹¤í–‰ ì‹œê°„ ì¸¡ì • ë° ì¶œë ¥
4. ê²°ê³¼ ì €ì¥: JSON + ìš”ì•½ í…ìŠ¤íŠ¸

## ğŸ”§ ìˆ˜ì •ëœ íŒŒì¼

### 1. `backend/app/api/routes.py`
ì „ëµ ë¹„êµ APIì— ìºì‹± ë¡œì§ ì¶”ê°€

**ë³€ê²½ ì‚¬í•­**:
```python
@router.post("/compare-strategies")
async def compare_strategies(request: StrategyComparisonRequest):
    # ìºì‹œ ì¸ìŠ¤í„´ìŠ¤ ê°€ì ¸ì˜¤ê¸°
    cache = get_cache()

    for strategy_name in request.strategy_names:
        # ìºì‹œ í™•ì¸
        cached_result = cache.get(
            symbols=request.symbols,
            start_date=request.start_date,
            end_date=request.end_date,
            strategy_name=strategy_name,
            initial_capital=request.initial_capital
        )

        if cached_result:
            # ìºì‹œ íˆíŠ¸: ì¦‰ì‹œ ë°˜í™˜
            logger.info(f"âœ… ìºì‹œ íˆíŠ¸: {strategy_name}")
            results.append(StrategyComparisonResult(**cached_result))
            continue

        # ìºì‹œ ë¯¸ìŠ¤: ë°±í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
        # ... (ê¸°ì¡´ ë°±í…ŒìŠ¤íŠ¸ ë¡œì§)

        # ê²°ê³¼ ìºì‹œì— ì €ì¥
        cache.set(
            symbols=request.symbols,
            start_date=request.start_date,
            end_date=request.end_date,
            strategy_name=strategy_name,
            initial_capital=request.initial_capital,
            result=strategy_result.dict()
        )
        logger.info(f"ğŸ’¾ ìºì‹œ ì €ì¥ ì™„ë£Œ: {strategy_name}")
```

## ğŸ“Š í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë°©ë²•

### 1. ë°±ì—”ë“œ ì„œë²„ ì‹œì‘

**Windows**:
```bash
START.bat
```

**Linux/Mac**:
```bash
cd backend
source venv/bin/activate
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 2. í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```bash
cd tests
python test_samsung_strategies.py
```

### 3. ì˜ˆìƒ ì¶œë ¥

```
==============================================================================================
  ì‚¼ì„±ì „ì ì „ëµ ë¹„êµ í…ŒìŠ¤íŠ¸ ì‹œì‘
==============================================================================================

ğŸ“‹ í…ŒìŠ¤íŠ¸ ì„¤ì •:
   - ì¢…ëª©: ì‚¼ì„±ì „ì (005930.KS)
   - ê¸°ê°„: 2024-01-01 ~ 2024-12-31
   - ì´ˆê¸° ìë³¸: 1,000,000ì›
   - í…ŒìŠ¤íŠ¸ ì „ëµ: 8ê°œ
     * buffett
     * lynch
     * graham
     * dalio
     * livermore
     * soros
     * druckenmiller
     * oneil

==============================================================================================
  1ì°¨ ì‹¤í–‰: ë°±í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ + ìºì‹œ ì €ì¥
==============================================================================================

âœ… 1ì°¨ ì‹¤í–‰ ì„±ê³µ
   - ì‹¤í–‰ ì‹œê°„: 45.23ì´ˆ
   - ì„±ê³µí•œ ì „ëµ: 8ê°œ

ğŸ’¾ ê²°ê³¼ ì €ì¥: test_results/samsung_2024/first_run_20250106_143022.json

==============================================================================================
  ì „ëµë³„ ì„±ê³¼ ë¶„ì„
==============================================================================================

ì „ëµëª…                 CAGR       Sharpe     MaxDD      ìŠ¹ë¥         ê±°ë˜ìˆ˜
--------------------------------------------------------------------------------
buffett                12.34%      1.45      -8.23%     65.00%           10
lynch                  15.67%      1.78      -10.12%    70.00%           15
graham                  8.90%      1.12      -6.45%     60.00%            8
dalio                   6.78%      0.98      -5.34%     55.00%            0
livermore              18.23%      2.01      -12.56%    68.00%           20
soros                  14.56%      1.67      -9.87%     66.00%           12
druckenmiller          16.89%      1.89      -11.23%    69.00%           18
oneil                  17.45%      1.92      -11.89%    71.00%           22

================================================================================
ğŸ† ìµœê³  ì„±ê³¼ ì „ëµ (CAGR ê¸°ì¤€): LIVERMORE
================================================================================

ğŸ“Š LIVERMORE ìƒì„¸ ì„±ê³¼:
   - ìµœì¢… ìë³¸: 1,182,300ì›
   - ì´ ìˆ˜ìµë¥ : 18.23%
   - CAGR: 18.23%
   - ìƒ¤í”„ ë¹„ìœ¨: 2.01
   - ìµœëŒ€ ë‚™í­: -12.56%
   - ìŠ¹ë¥ : 68.00%
   - ì´ ê±°ë˜ ìˆ˜: 20íšŒ

==============================================================================================
  2ì°¨ ì‹¤í–‰: ìºì‹œì—ì„œ ì¦‰ì‹œ ë°˜í™˜
==============================================================================================

âœ… 2ì°¨ ì‹¤í–‰ ì„±ê³µ (ìºì‹œ ì‚¬ìš©)
   - ì‹¤í–‰ ì‹œê°„: 0.32ì´ˆ
   - ì„±ê³µí•œ ì „ëµ: 8ê°œ

ğŸ’¾ ê²°ê³¼ ì €ì¥: test_results/samsung_2024/second_run_cached_20250106_143108.json

==============================================================================================
  ìºì‹± ì„±ëŠ¥ ë¹„êµ
==============================================================================================

â±ï¸  ì‹¤í–‰ ì‹œê°„ ë¹„êµ:
   - 1ì°¨ ì‹¤í–‰ (ë°±í…ŒìŠ¤íŠ¸): 45.23ì´ˆ
   - 2ì°¨ ì‹¤í–‰ (ìºì‹œ): 0.32ì´ˆ
   - ì†ë„ í–¥ìƒ: 141.3ë°° ë¹ ë¦„
   - ì ˆì•½ëœ ì‹œê°„: 44.91ì´ˆ

âœ… ìºì‹±ì´ ë§¤ìš° íš¨ê³¼ì ì…ë‹ˆë‹¤! (141.3ë°° ë¹ ë¦„)

==============================================================================================
  í…ŒìŠ¤íŠ¸ ì™„ë£Œ
==============================================================================================

âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!
ğŸ“ ê²°ê³¼ ì €ì¥ ìœ„ì¹˜: /home/user/auto_stock/tests/test_results/samsung_2024
ğŸ“… í…ŒìŠ¤íŠ¸ ì¢…ë£Œ: 2025-01-06 14:31:08
================================================================================
```

## ğŸ“ˆ ê²°ê³¼ íŒŒì¼ êµ¬ì¡°

```
test_results/samsung_2024/
â”œâ”€â”€ first_run_20250106_143022.json          # 1ì°¨ ì‹¤í–‰ ì „ì²´ ê²°ê³¼
â”œâ”€â”€ second_run_cached_20250106_143108.json  # 2ì°¨ ì‹¤í–‰ (ìºì‹œ) ê²°ê³¼
â””â”€â”€ summary.txt                              # ìš”ì•½ ë³´ê³ ì„œ
```

### summary.txt ì˜ˆì‹œ

```
================================================================================
ì‚¼ì„±ì „ì ì „ëµ ë¹„êµ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½ (2024ë…„)
================================================================================

í…ŒìŠ¤íŠ¸ ì¼ì‹œ: 2025-01-06 14:31:08
ì¢…ëª©: ì‚¼ì„±ì „ì (005930.KS)
ê¸°ê°„: 2024-01-01 ~ 2024-12-31
ì´ˆê¸° ìë³¸: 1,000,000ì›

--------------------------------------------------------------------------------
ì „ëµëª…                 CAGR       Sharpe     MaxDD      ìŠ¹ë¥ 
--------------------------------------------------------------------------------
buffett                12.34%      1.45      -8.23%     65.00%
lynch                  15.67%      1.78      -10.12%    70.00%
graham                  8.90%      1.12      -6.45%     60.00%
dalio                   6.78%      0.98      -5.34%     55.00%
livermore              18.23%      2.01      -12.56%    68.00%
soros                  14.56%      1.67      -9.87%     66.00%
druckenmiller          16.89%      1.89      -11.23%    69.00%
oneil                  17.45%      1.92      -11.89%    71.00%

================================================================================
ğŸ† ìµœê³  ì„±ê³¼ ì „ëµ: LIVERMORE
================================================================================
```

## ğŸ” ìºì‹œ ê´€ë¦¬ API

### ìºì‹œ í†µê³„ ì¡°íšŒ (ì˜ˆì •)

```python
GET /api/v1/cache/stats
```

**ì‘ë‹µ**:
```json
{
  "total_files": 48,
  "total_size_mb": 12.34,
  "cache_dir": "backend/cache/backtest_results"
}
```

### ìºì‹œ ì‚­ì œ (ì˜ˆì •)

```python
DELETE /api/v1/cache/clear?older_than_days=30
```

**íŒŒë¼ë¯¸í„°**:
- `older_than_days`: 30ì¼ ì´ìƒ ì˜¤ë˜ëœ ìºì‹œë§Œ ì‚­ì œ (ìƒëµ ì‹œ ì „ì²´ ì‚­ì œ)

## âš™ï¸ ìºì‹± ë¹„í™œì„±í™”

ìºì‹±ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´ í™˜ê²½ë³€ìˆ˜ ì„¤ì •:

```bash
# .env íŒŒì¼
DISABLE_BACKTEST_CACHE=true
```

## ğŸ¯ í™œìš© ì‚¬ë¡€

### 1. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì „ëµ ë¹„êµ

```typescript
// frontend/src/services/api.ts
const response = await compareStrategies({
  strategy_names: ["buffett", "lynch", "graham"],
  symbols: ["005930.KS"],
  start_date: "2024-01-01",
  end_date: "2024-12-31",
  initial_capital: 1000000
});

// ì²« ì‹¤í–‰: 30ì´ˆ ì†Œìš”
// ë™ì¼í•œ ìš”ì²­ ì¬ì‹¤í–‰: 0.3ì´ˆ ì†Œìš” (100ë°° ë¹ ë¦„!)
```

### 2. ì—¬ëŸ¬ ì¢…ëª© ë™ì‹œ ë¹„êµ

```python
# ë™ì¼í•œ ì „ëµìœ¼ë¡œ ì—¬ëŸ¬ ì¢…ëª© ë¹„êµ
payload = {
    "strategy_names": ["buffett"],
    "symbols": ["005930.KS", "000660.KS", "035420.KS"],  # ì‚¼ì„±ì „ì, SKí•˜ì´ë‹‰ìŠ¤, ë„¤ì´ë²„
    "start_date": "2024-01-01",
    "end_date": "2024-12-31",
    "initial_capital": 1000000
}

# ê° ì¢…ëª©ë³„ë¡œ ìºì‹œ ìƒì„±
# ì¬ìš”ì²­ ì‹œ ëª¨ë“  ì¢…ëª© ê²°ê³¼ ì¦‰ì‹œ ë°˜í™˜
```

### 3. ê¸°ê°„ë³„ ì„±ê³¼ ë¹„êµ

```python
# 2023ë…„ vs 2024ë…„ ì„±ê³¼ ë¹„êµ
for year in ["2023", "2024"]:
    payload = {
        "strategy_names": ["livermore"],
        "symbols": ["005930.KS"],
        "start_date": f"{year}-01-01",
        "end_date": f"{year}-12-31",
        "initial_capital": 1000000
    }
    # ê° ì—°ë„ë³„ë¡œ ìºì‹œ ìƒì„±
```

## ğŸ“ ì£¼ì˜ì‚¬í•­

1. **ë°ì´í„° ê°±ì‹ **: ì‹¤ì‹œê°„ ì£¼ê°€ ë°ì´í„°ê°€ ë³€ê²½ë˜ì–´ë„ ìºì‹œëŠ” ìë™ìœ¼ë¡œ ê°±ì‹ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
   - ìµœì‹  ë°ì´í„° ë°˜ì˜ì´ í•„ìš”í•˜ë©´ ìºì‹œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì‚­ì œí•˜ì„¸ìš”.

2. **ë””ìŠ¤í¬ ìš©ëŸ‰**: ìºì‹œ íŒŒì¼ì€ ê³„ì† ëˆ„ì ë˜ë¯€ë¡œ ì£¼ê¸°ì ìœ¼ë¡œ ì •ë¦¬ í•„ìš”
   - ê¶Œì¥: 30ì¼ ì´ìƒ ì˜¤ë˜ëœ ìºì‹œëŠ” ìë™ ì‚­ì œ

3. **íŒŒë¼ë¯¸í„° ë¯¼ê°**: íŒŒë¼ë¯¸í„°ê°€ ì¡°ê¸ˆì´ë¼ë„ ë‹¤ë¥´ë©´ ìƒˆë¡œìš´ ìºì‹œ ìƒì„±
   - `symbols: ["005930.KS"]` â‰  `symbols: ["005930.KS", "000660.KS"]`
   - `initial_capital: 1000000` â‰  `initial_capital: 1000001`

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

- [ ] ìºì‹œ í†µê³„ API êµ¬í˜„
- [ ] ìºì‹œ ì‚­ì œ API êµ¬í˜„
- [ ] ìºì‹œ TTL (Time-To-Live) ì„¤ì •
- [ ] Redis ìºì‹± ì˜µì…˜ ì¶”ê°€
- [ ] ìºì‹œ ì›Œë° (ì‚¬ì „ ìºì‹±) ê¸°ëŠ¥

## ğŸ“§ ë¬¸ì˜

ì´ìŠˆê°€ ìˆìœ¼ë©´ GitHub Issuesì— ë“±ë¡í•´ì£¼ì„¸ìš”.
